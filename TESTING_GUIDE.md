# 游戏系统测试指南

本指南将帮助您测试CardAddictionQuitter应用的核心功能。测试脚本可以验证应用的关键系统是否正常工作，包括任务系统、抽卡系统、数据持久化以及它们之间的集成。

## 测试准备

在运行测试前，请确保：

1. 您已安装最新版本的Xcode
2. 项目已正确配置Core Data数据模型
3. 所有必要的Swift文件已包含在项目中

## 测试文件说明

项目中包含两个主要的测试文件：

1. **GameSystemTest.swift** - 完整的游戏系统测试类，包含详细的功能测试
2. **RunTests.swift** - 简单的测试运行器，提供基本功能的快速测试

## 如何运行测试

### 方法1：通过Xcode运行GameSystemTest

1. 在Xcode中打开项目
2. 定位到 `GameSystemTest.swift` 文件
3. 取消注释文件底部的测试运行代码：
   ```swift
   // let gameTest = GameSystemTest()
   // gameTest.runFullTest()
   ```
   修改为：
   ```swift
   let gameTest = GameSystemTest()
   gameTest.runFullTest()
   ```
4. 点击Xcode顶部的运行按钮或使用快捷键 `Command+R`
5. 在控制台查看测试结果

### 方法2：通过Xcode运行RunTests

1. 在Xcode中打开项目
2. 定位到 `RunTests.swift` 文件
3. 点击Xcode顶部的运行按钮或使用快捷键 `Command+R`
4. 在控制台查看快速测试结果

## 测试内容详解

### GameSystemTest.swift 包含的测试

1. **任务系统测试**
   - 测试获取可用任务列表
   - 测试完成任务功能
   - 测试任务冷却机制（防止重复完成）
   - 测试概率提升值计算

2. **抽卡系统测试**
   - 测试单抽功能
   - 测试10连抽功能
   - 统计并显示抽卡结果
   - 验证概率配置

3. **任务系统和抽卡系统集成测试**
   - 模拟完成任务获取概率提升
   - 测试带概率提升的抽卡功能
   - 验证概率提升是否正确应用

4. **保底机制测试**
   - 测试保底计数器的重置和增加
   - 验证保底状态查询
   - 模拟触发SR保底机制

### RunTests.swift 包含的测试

- Core Data初始化测试
- 任务类型枚举访问测试
- 抽卡系统基本功能测试
- 概率配置显示

## 预期测试结果

成功的测试应该显示：

- Core Data初始化成功
- 能够获取可用任务列表
- 任务可以成功完成且有冷却机制
- 抽卡功能正常，能够获得不同稀有度的卡牌
- 10连抽至少有一张SR或更高稀有度的卡牌
- 任务完成后能够获得概率提升
- 保底机制正常工作

## 注意事项

1. 测试使用内存中的Core Data存储，不会影响实际应用数据
2. 部分测试依赖随机生成，每次运行的结果可能会有所不同
3. 如果测试失败，请检查相关类的实现是否正确
4. 测试中的保底机制模拟仅用于展示，实际应用中的保底逻辑可能有所不同

## 自定义测试

您可以根据需要修改测试文件，添加更多的测试场景或调整现有测试的参数。例如：

- 增加更多的抽卡测试次数来验证概率分布
- 测试不同难度任务的概率提升效果
- 模拟不同的用户行为路径

## 故障排除

如果测试失败，请检查以下几点：

1. Core Data模型配置是否正确
2. 相关类是否正确实现
3. 是否有缺失的依赖项
4. Xcode版本是否兼容

如果问题仍然存在，请检查控制台输出的详细错误信息，以便进一步诊断问题。